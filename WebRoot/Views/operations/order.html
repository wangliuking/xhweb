<!DOCTYPE html>
<html>
<head>
<title>运维派单</title>
<meta name="keywords" content="keyword1,keyword2,keyword3">
<meta name="description" content="this is my page">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Cache-Control" content="no-cache">
<meta http-equiv="Expires" content="-1">
<script type="text/javascript"
	src="../../Resources/js/xhbootstrap-css.js"></script>
<!-- <script type="text/javascript" src="../../Resources/js/jquery-1.7.2.js"></script> -->
<!--[if lte IE 9]>
<script src="../../Resources/js/respond.min.js"></script>
<script src="../../Resources/js/html5shiv.js"></script>
<![endif]-->
<style type="text/css">
.hpanel panel-body{
 background:#000;
}
</style>
<script language="javascript" src="../../Resources/js/LodopFuncs.js"></script>
<object id="LODOP_OB"
	classid="clsid:2105C259-1E0C-4534-8141-A753534CB4CA" width=0 height=0>
	<embed id="LODOP_EM" type="application/x-print-lodop" width=0 height=0></embed>
</object>
</head>
<body ng-app="app" ng-controller="xhcontroller" class="fixed-iframe">
	<!-- splash screen-->
	<div class="splash">
		<div class="splash-title">
			<h1>系统正在努力加载中，请耐心等待</h1>
			<div class="spinner">
				<div class="rect1"></div>
				<div class="rect2"></div>
				<div class="rect3"></div>
				<div class="rect4"></div>
				<div class="rect5"></div>
			</div>
		</div>
	</div>
	<!-- 中间内容体 -->
	<div id="wrapper">
		<div class="small-header transition animated fadeIn">
			<div class="title-panel">
				<div class="panel-body">
					<div id="hbreadcrumb" class="pull-left">
						<ol class="hbreadcrumb breadcrumb">
							<li><span>当前位置：</span></li>
							<!-- <li><span>运维管理</span></li>
							<li><span>系统运维</span></li> -->
							<li class="active"><span>派单列表</span></li>
						</ol>
					</div>
				</div>
			</div>
		</div>
		<div class="content animate-panel">
			<div class="row">
				<div class="col-md-12">
					<div class="hpanel">
						<div class="panel-heading hbuilt">
							<div class="panel-tools">
								<a class="showhide"><i class="fa fa-chevron-up"></i></a>
							</div>
							<i class="fa fa-search"></i> 查询数据
						</div>
						<div class="panel-body">
							<div id="search-div">
								<form class="form-inline" role="form">
									<div class="form-group">
										<label for="filename">基站ID/名称</label>
										<div>
											<input type="text" class="form-control" id="bs"
												width="20px">
										</div>
									</div>
									<div class="form-group">
										<label for="filename">派单人</label>
										<div>
											<input type="text" class="form-control" id="dispatchman"
												width="20px">
										</div>
									</div>
									<div class="form-group">
										<label for="filename">接单人</label>
										<div>
											<input type="text" class="form-control" id="recv_user"
												width="20px">
										</div>
									</div>
									<div class="form-group">
										<label for="filename">抄送人</label>
										<div>
											<input type="text" class="form-control" id="copy_user"
												width="20px">
										</div>
									</div>
									<div class="form-group">
										<label for="filename">故障类型</label>
										<div>
											<select  class="form-control" id="type" width="20px">	
												<option value="" selected="selected">==所有==</option>
												<option value="断站故障">断站故障</option>
												<option value="隐患故障">隐患故障</option>
												<option value="机房配套问题">机房配套问题</option>
											</select>
										</div>
									</div>
									<div class="form-group">
										<label for="filename">状态</label>	
										<div>
											<select  class="form-control" id="status" width="20px">	
												<option value="" selected="selected">==所有==</option>
												<option value="-1">审核失败</option>
												<option value="-2">挂单中</option>
												<option value="0">接单中</option>
												<option value="1">处理中</option>
												<option value="2">审核中</option>
												<option value="3">审核通过</option>
												<option value="4">工单结束</option>
											</select>
										</div>
									</div>
									<div class="form-group">
										<label for="contact">派单时间（起始）</label>
										<div>
											<input type="text" class="form-control" id="starttime"
											onfocus="WdatePicker({dateFmt:'yyyy-MM-dd'})">
										</div>
									</div>
									<div class="form-group">
                                        <label for="contact">派单时间（结束）</label>
                                        <div>
                                            <input type="text" class="form-control" id="endtime"
                                            onfocus="WdatePicker({dateFmt:'yyyy-MM-dd'})">
                                        </div>
                                    </div>
									

									<div class="form-group">
										<div class="col-sm-offset-2" style="padding-top:22px">
											<button type="submit" class="btn btn-sm btn-success"
												ng-click="search(1)">
												<i class="fa fa-search"></i>&nbsp;查询
											</button>
										</div>
									</div>
									<div class="form-group">
										<div class="col-sm-offset-2" style="padding-top:22px">
											<button class="btn btn-primary btn-sm" id="btn-excel" data-loading-text="正在分析数据" 
											ng-click="excel()">
												<i class="fa fa-file-excel-o"></i>&nbsp;导出excel
											</button>
										</div>
									</div>

								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- row -->

			<div class="row">
				<div class="col-md-12">
					<div class="hpanel">
					<div class="panel-heading hbuilt">
							<div class="panel-tools">
								<a class="showhide"><i class="fa fa-chevron-up"></i></a>
							</div>
							<i class="fa fa-list"></i> 派单列表
						</div>
						<div class="panel-body" style="padding:0;margin:0">
						<button class="btn btn-danger btn-sm" onclick="xh.delMore()"
										ng-if="(userL.roleType==3 && up.o_delete=='on') || userL.roleType==0">
										<i class="fa fa-trash"></i>&nbsp;批量删除
									</button>
						<table id="tb-info" class="xh-table table-hover"
								style="table-layout:fixed">
								<thead>
									<tr class="tr-gray">
										<th width="30px"><input type="checkbox"
											id="table-checkbox" class="table-check" /></th> 
										<th >基站</th>
										<th width="180px">派单时间</th>
										<th >故障类型</th>
										<th >故障描述</th>
										<th width="120px">派单人</th>
										<th width="80px">状态</th>
										<th width="120px">接单人</th>
										<th >处理</th>
									</tr>
								</thead>
								<tbody>
									<tr ng-if="totals==0">
										<td colspan="9" class="text-center">没有记录！</td>
									</tr>
									<tr ng-repeat="x in data">
										<td><input type="checkbox" name="tb-check"
											value="{{x.id}}" index="{{$index}}" /></td>
										<td><a href="" ng-click="editModel($index)" data-toggle="modal" style="color:blue;">
									【{{x.bsid}}-{{x.bsname}}】 </a></td>
										<td>{{x.dispatchtime}}</td>
										<td>{{x.errtype}}</td>
										<td>{{x.progress}}</td>
										<td>{{x.dispatchman}}</td>
										<td>
										<strong ng-if="x.status==-2" style="red">挂单中</strong>
										<strong ng-if="x.status==-1" style="color:red">审核未通过，等待再次提交</strong>
										<strong ng-if="x.status==0" style="color:gray">接单中</strong> 
										<strong ng-if="x.status==1" style="color:gray">处理中</strong> 
										<strong ng-if="x.status==2" style="color:gray">审核中</strong>
										<strong ng-if="x.status==3" style="color:blue">审核通过</strong>
										<strong ng-if="x.status==4" style="color:green">工单结束</strong>											
										</td>
										<td>{{x.userName}}</td>
										<td>
										<a href="#" ng-click="del($index)"
                                class="text-danger" ng-if="(userL.roleType==3 && up.o_delete=='on') || userL.roleType==0"> 
                                <img src="../../Resources/images/icon/del.png">&nbsp;删除
                                          </a>
									<!-- 	<a href="#" ng-click="resend($index)"
								 ng-if="x.status==0 && up.o_order=='on'" style="color:green"> <i class="fa fa-hand-stop-o"></i>&nbsp;重新发送
							</a> --><a href="#" ng-click="check($index)"
								class="text-success" ng-if="(x.status==2) && up.o_order=='on'"> <i class="fa fa-hand-stop-o"></i>&nbsp;请确认已解决
							</a>
							<a href="#" ng-click="showOrderUpdateWin($index)"
								class="text-success" ng-if="(x.status==0) && up.o_order=='on'"> <i class="fa fa-edit text-success"></i>&nbsp;修改
							</a>
							<a href="#" ng-click="checkFail($index)"
								   class="text-success" ng-if="x.status==2"> <i class="fa fa-hand-stop-o"></i>&nbsp;该故障未解决
										</a><!-- <span ng-if="x.status==3" style="color:gray">该单号结束!</span> -->
										</td>
									</tr>
								</tbody>
							</table>
							<div class="page">
								<div class="page-info">
									每页显示 <select id="page-limit" ng-change="refresh()"
										ng-model="count">
										<option value="20">10</option>
										<option value="20">15</option>
										<option value="20">20</option>
										<option value="30">30</option>
										<option value="40">40</option>
										<option value="50">50</option>
									</select> 条, <span ng-model="index">显示{{start}}-</span><span
										ng-model="lastIndex">{{lastIndex}}条,</span> <span
										ng-model="totals">总计{{totals}}条</span>
										<i class="fa fa-refresh page-refresh" title="刷新数据" ng-click="refresh()"></i>
								</div>
								
								<div class="page-paging"></div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<!-- <div class="row" style="">
				<div class="text-center" ng-if="totals==0">没有记录！</div>
				<div class="col-md-3" ng-repeat="x in data">

					<div class="hpanel">
					    <div class="panel-heading hbuilt">
							<div class="panel-tools">
								<a href="#" ng-click="resend($index)"
								 ng-if="x.status==0" style="color:#FF00FF"> <i class="fa fa-hand-stop-o"></i>&nbsp;重新发送
							</a>
							<a href="#" ng-click="check($index)"
								class="text-success" ng-if="x.status==1"> <i class="fa fa-hand-stop-o"></i>&nbsp;请确认已解决
							</a>
							</div>
							<a href="" ng-click="editModel($index)" data-toggle="modal" style="color:blue;">
									【{{x.bsid}}-{{x.bsname}}】 </a>
						</div>
						<div class="panel-body">
							


							<div class="text-muted font-bold m-b-xs">
								<a href="" ng-click="editModel($index)" data-toggle="modal" style="color:skyblue;">
									【{{x.bsid}}-{{x.bsname}}】故障处理任务单 </a>
							</div>
							<p>
								<span style='font-weight:700'>派单时间：</span>&nbsp;<span>{{x.dispatchtime}}</span>
							</p>
							<p>
								<span style='font-weight:700'>故障类型：</span>&nbsp;<span>{{x.errtype}}</span>
							</p>
							<p>
								<span style='font-weight:700'>故障等级：</span>&nbsp;<span>{{x.errlevel}}</span>
							</p>
							
						</div>
						<div class="panel-footer contact-footer">
							<div class="row">
								<div class="col-md-4 border-right">
									<div class="contact-stat">contact-panel
										<span>派单人 </span> <strong style="color:#000">{{x.dispatchman}}</strong>
									</div>
								</div>
								<div class="col-md-4 border-right">
									<div class="contact-stat">
										<span>状态 </span> <strong ng-if="x.status==0"
											class="text-danger">接单中</strong> <strong ng-if="x.status==1"
											style="color:blue">处理中</strong> <strong ng-if="x.status==2"
											style="color:green">已完成</strong>
									</div>
								</div>
								<div class="col-md-4">
									<div class="contact-stat">
										<span>接单人 </span> <strong style="color:#000">{{x.userName}}</strong>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>

			</div> -->


			<!-- row/ -->
		</div>
	</div>
	<!-- 中间内容体 /-->
	<div class="scroll-top text-info animated fadeIn scroll-top-hide">
		<i class="fa fa-chevron-circle-up fa-3x"></i>
	</div>
	<div ng-include="'order-detail.html'"></div>
	<div ng-include="'order-update.html'"></div>
	<div class="scroll-top text-info animated fadeIn scroll-top-hide">
		<i class="fa fa-chevron-circle-up fa-3x"></i>
	</div>
	<script type="text/javascript"
		src="../../Resources/js/xhbootstrap-js.js"></script>
	<script type="text/javascript"
		src="../../Controllers/operations/order.js"></script>
	<script type="text/javascript"
		src="../../Resources/js/ajaxfileupload.js"></script>
	<script type="text/javascript">
		xh.load();
	</script>
</body>
</html>
